@media print {

  /* Configuração de página LANDSCAPE para impressão de fichas */
  @page {
    size: A4 landscape !important;
    margin: 0 !important;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html,
  body {
    margin: 0 !important;
    padding: 0 !important;
    width: 297mm !important;
    height: 210mm !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Remover margens e padding de todos os containers */
  .container,
  [class*="container"] {
    margin: 0 !important;
    padding: 0 !important;
    max-width: none !important;
    width: 100% !important;
  }

  /* Remover estilos de Card e outros componentes UI */
  [class*="card"],
  [class*="Card"] {
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    box-shadow: none !important;
    background: transparent !important;
  }

  /* Wrapper com dimensões fixas para A4 landscape - 1 turma por folha */
  .ficha-print-wrapper {
    width: 297mm !important;
    height: 210mm !important;
    min-width: 297mm !important;
    min-height: 210mm !important;
    max-width: 297mm !important;
    max-height: 210mm !important;
    margin: 0 !important;
    padding: 10mm !important;
    box-sizing: border-box !important;
    transform: none !important;
    transform-origin: top left !important;
    page-break-inside: avoid !important;
    page-break-after: always !important;
    overflow: hidden !important;
    position: relative !important;
  }

  /* Remover quebra de página da última ficha */
  .ficha-print-wrapper:last-of-type {
    page-break-after: auto !important;
  }

  /* Regras específicas para geração de PDF via html2pdf */
  .ficha-print-wrapper {
    page-break-after: always !important;
    page-break-inside: avoid !important;
  }

  .ficha-print-wrapper:last-child {
    page-break-after: auto !important;
  }

  .ficha-container {
    width: 100% !important;
    height: 100% !important;
    max-width: 277mm !important;
    max-height: 190mm !important;
    margin: 0 !important;
    padding: 0 !important;
    box-sizing: border-box !important;
    page-break-inside: avoid !important;
  }

  /* Reset de escala para garantir 100% */
  html {
    zoom: 1 !important;
    -webkit-text-size-adjust: 100% !important;
    font-size: 12pt !important;
  }

  /* Tabela com largura fixa para A4 landscape */
  .ficha-tabela {
    width: 277mm !important;
    max-width: 277mm !important;
    table-layout: fixed !important;
    border-collapse: collapse !important;
  }

  .no-print {
    display: none !important;
  }

  .print-only {
    display: block !important;
  }

  .ficha-container table {
    page-break-inside: avoid;
    border-collapse: collapse;
    width: 100%;
  }

  /* Configurações de quebra de página */
  .print\:page-break-after {
    page-break-after: always !important;
  }


  /* Garantindo que TODAS as bordas internas sejam finas durante a impressão */
  .ficha-tabela th,
  .ficha-tabela td {
    border: 0.5px solid #999 !important;
  }

  /* Bordas grossas para as colunas principais com cores específicas */
  .borda-faltas,
  .ficha-tabela .borda-faltas,
  th.borda-faltas,
  td.borda-faltas {
    border-left: 2px solid #000000 !important;
    border-right: 2px solid #000000 !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  .borda-semana-1,
  .ficha-tabela .borda-semana-1,
  th.borda-semana-1,
  td.borda-semana-1 {
    border-left: 2px solid #ea384c !important;
    border-right: 2px solid #ea384c !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  .borda-semana-2,
  .ficha-tabela .borda-semana-2,
  th.borda-semana-2,
  td.borda-semana-2 {
    border-left: 2px solid #000000 !important;
    border-right: 2px solid #000000 !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  .borda-semana-3,
  .ficha-tabela .borda-semana-3,
  th.borda-semana-3,
  td.borda-semana-3 {
    border-left: 2px solid #ea384c !important;
    border-right: 2px solid #ea384c !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  .borda-semana-4,
  .ficha-tabela .borda-semana-4,
  th.borda-semana-4,
  td.borda-semana-4 {
    border-left: 2px solid #000000 !important;
    border-right: 2px solid #000000 !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  .borda-semana-5,
  .ficha-tabela .borda-semana-5,
  th.borda-semana-5,
  td.borda-semana-5 {
    border-left: 2px solid #ea384c !important;
    border-right: 2px solid #ea384c !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Regra específica para garantir que as bordas internas das subcolunas sejam sempre finas */
  .ficha-subcoluna-falta:not(:first-of-type):not(:last-of-type),
  .ficha-subcoluna:not(:first-of-type):not(:last-of-type) {
    border-left: 0.5px solid #999 !important;
    border-right: 0.5px solid #999 !important;
  }

  /* Garantir que apenas as subcolunas nas extremidades tenham bordas grossas */
  .ficha-subcoluna-falta:first-of-type {
    border-left: 2px solid !important;
    border-left-color: inherit !important;
    border-right: 0.5px solid #999 !important;
  }

  .ficha-subcoluna-falta:last-of-type {
    border-right: 2px solid !important;
    border-right-color: inherit !important;
    border-left: 0.5px solid #999 !important;
  }

  .ficha-subcoluna.borda-semana-1:first-of-type,
  .ficha-subcoluna.borda-semana-2:first-of-type,
  .ficha-subcoluna.borda-semana-3:first-of-type,
  .ficha-subcoluna.borda-semana-4:first-of-type,
  .ficha-subcoluna.borda-semana-5:first-of-type {
    border-left: 2px solid !important;
    border-left-color: inherit !important;
    border-right: 0.5px solid #999 !important;
  }

  .ficha-subcoluna.borda-semana-1:last-of-type,
  .ficha-subcoluna.borda-semana-2:last-of-type,
  .ficha-subcoluna.borda-semana-3:last-of-type,
  .ficha-subcoluna.borda-semana-4:last-of-type,
  .ficha-subcoluna.borda-semana-5:last-of-type {
    border-right: 2px solid !important;
    border-right-color: inherit !important;
    border-left: 0.5px solid #999 !important;
  }

  /* Remover qualquer estilo que possa estar interferindo nas bordas entre subcolunas */
  .ficha-subcoluna+.ficha-subcoluna,
  .ficha-subcoluna-falta+.ficha-subcoluna-falta {
    border-left: 0.5px solid #999 !important;
  }

  /* Forçar o background e cores a serem impressos - Regra mais específica */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  /* Estilos específicos para cabeçalhos coloridos - adicionados seletores mais específicos */
  .borda-semana-1,
  [class*="borda-semana-1"] * {
    border-color: #ea384c !important;
    color: #ea384c !important;
  }

  .borda-semana-2,
  [class*="borda-semana-2"] * {
    border-color: #000000 !important;
    color: #000000 !important;
  }

  .borda-semana-3,
  [class*="borda-semana-3"] * {
    border-color: #ea384c !important;
    color: #ea384c !important;
  }

  .borda-semana-4,
  [class*="borda-semana-4"] * {
    border-color: #000000 !important;
    color: #000000 !important;
  }

  .borda-semana-5,
  [class*="borda-semana-5"] * {
    border-color: #ea384c !important;
    color: #ea384c !important;
  }

  /* Adicionar força extra às bordas e cores */
  .ficha-tabela th.borda-faltas,
  .ficha-tabela td.borda-faltas {
    border-left: 2px solid #000000 !important;
    border-right: 2px solid #000000 !important;
  }

  .ficha-tabela th.borda-semana-1,
  .ficha-tabela td.borda-semana-1 {
    border-left: 2px solid #ea384c !important;
    border-right: 2px solid #ea384c !important;
  }

  .ficha-tabela th.borda-semana-2,
  .ficha-tabela td.borda-semana-2 {
    border-left: 2px solid #000000 !important;
    border-right: 2px solid #000000 !important;
  }

  .ficha-tabela th.borda-semana-3,
  .ficha-tabela td.borda-semana-3 {
    border-left: 2px solid #ea384c !important;
    border-right: 2px solid #ea384c !important;
  }

  .ficha-tabela th.borda-semana-4,
  .ficha-tabela td.borda-semana-4 {
    border-left: 2px solid #000000 !important;
    border-right: 2px solid #000000 !important;
  }

  .ficha-tabela th.borda-semana-5,
  .ficha-tabela td.borda-semana-5 {
    border-left: 2px solid #ea384c !important;
    border-right: 2px solid #ea384c !important;
  }

  /* Garantir que as células com fundo amarelo para alunos recentes sejam impressas corretamente */
  .ficha-celula-nome {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
    position: relative !important;
    overflow: visible !important;
    z-index: 10 !important;
  }

  /* Permitir que nomes sobreporem outras colunas */
  .ficha-aluno-nome {
    padding-top: 0 !important;
    padding-bottom: 4px !important;
    display: inline-block !important;
    vertical-align: top !important;
    z-index: 100 !important;
    background-color: rgba(255, 255, 255, 0.95) !important;
    padding-right: 4px !important;
    white-space: nowrap !important;
    overflow: visible !important;
  }

  /* Ajustar posição vertical das células de falta e semana */
  .ficha-celula-falta,
  .ficha-celula-semana {
    padding: 0 !important;
    vertical-align: top !important;
  }

  /* Subcolunas dos headers */
  .ficha-subcoluna,
  .ficha-subcoluna-falta {
    padding-top: 0 !important;
    padding-bottom: 1px !important;
    vertical-align: top !important;
  }

  /* Regra específica para alunos recentes com fundo amarelo - corrigida para aplicar apenas quando tiver style inline */
  .ficha-celula-nome[style*="background-color: rgb(254, 247, 205)"] {
    background-color: #FEF7CD !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }
}

/* Estilos gerais da ficha */
.ficha-container {
  font-family: Arial, sans-serif;
  max-width: 100%;
  margin: 0 auto;
  padding: 8px;
  font-size: 13pt;
}

/* Wrapper para controle de dimensões na impressão */
.ficha-print-wrapper {
  width: 100%;
  height: auto;
}

/* Estilos do cabeçalho */
.ficha-cabecalho {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 4px;
  border-bottom: 1px solid #000;
  padding-bottom: 4px;
}

.ficha-info {
  display: flex;
  gap: 12px;
}

.ficha-campo {
  display: flex;
  gap: 4px;
}

.ficha-label {
  font-weight: bold;
  font-size: 25pt;
}

.ficha-valor {
  font-size: 25pt;
}

/* Título do mês e ano */
.ficha-mes-ano {
  text-align: center;
  margin-bottom: 4px;
}

.ficha-mes-ano h2 {
  font-size: 14pt;
  font-weight: bold;
  margin: 0;
  text-transform: capitalize;
}

@media print {
  .ficha-mes-ano h2 {
    font-size: 14pt;
  }
}

.ficha-navegacao {
  display: flex;
  align-items: center;
  gap: 8px;
  /* Reduzido de 10px para 8px */
}

.ficha-setas {
  display: flex;
  gap: 3px;
  /* Reduzido de 5px para 3px */
}

.seta-pagina {
  background: none;
  border: 1px solid #ccc;
  border-radius: 3px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2px;
}

/* Estilos da tabela */
.ficha-tabela {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 4px;
  table-layout: fixed;
}

/* Configuração base para todas as células - bordas finas com altura fixa */
.ficha-tabela th,
.ficha-tabela td {
  border: 0.5px solid #999;
  padding: 0.5mm;
  vertical-align: middle;
  text-align: center;
  height: 6mm;
  line-height: 1.1;
}

@media print {

  .ficha-tabela th,
  .ficha-tabela td {
    height: 6mm !important;
    padding: 0.5mm !important;
    line-height: 1.1 !important;
    font-size: 11pt !important;
  }
}

/* As bordas laterais das colunas principais são grossas */
/* Bordas laterais da coluna de faltas */
.ficha-coluna-faltas {
  border-left: 2px solid #000000;
  border-right: 2px solid #000000;
}

/* Bordas laterais específicas para subcolunas */
.ficha-subcoluna-falta.borda-faltas {
  border-right: 0.5px solid #999;
}

.ficha-subcoluna-falta.borda-faltas:first-of-type {
  border-left: 2px solid #000000 !important;
}

.ficha-subcoluna-falta.borda-faltas:last-of-type {
  border-right: 2px solid #000000 !important;
}

/* Bordas laterais para as colunas de semanas */
.ficha-coluna-semana {
  border-left: 2px solid;
  border-right: 2px solid;
}

/* Bordas específicas para subcolunas de semanas */
.ficha-subcoluna.borda-semana-1:first-of-type {
  border-left: 2px solid #ea384c !important;
}

.ficha-subcoluna.borda-semana-1:last-of-type {
  border-right: 2px solid #ea384c !important;
}

.ficha-subcoluna.borda-semana-2:first-of-type {
  border-left: 2px solid #000000 !important;
}

.ficha-subcoluna.borda-semana-2:last-of-type {
  border-right: 2px solid #000000 !important;
}

.ficha-subcoluna.borda-semana-3:first-of-type {
  border-left: 2px solid #ea384c !important;
}

.ficha-subcoluna.borda-semana-3:last-of-type {
  border-right: 2px solid #ea384c !important;
}

.ficha-subcoluna.borda-semana-4:first-of-type {
  border-left: 2px solid #000000 !important;
}

.ficha-subcoluna.borda-semana-4:last-of-type {
  border-right: 2px solid #000000 !important;
}

.ficha-subcoluna.borda-semana-5:first-of-type {
  border-left: 2px solid #ea384c !important;
}

.ficha-subcoluna.borda-semana-5:last-of-type {
  border-right: 2px solid #ea384c !important;
}

/* Estilização para os headers das colunas principais que são spans múltiplos */
.borda-faltas {
  border-left: 2px solid #000000 !important;
  border-right: 2px solid #000000 !important;
}

.borda-semana-1 {
  border-left: 2px solid #ea384c !important;
  border-right: 2px solid #ea384c !important;
}

.borda-semana-2 {
  border-left: 2px solid #000000 !important;
  border-right: 2px solid #000000 !important;
}

.borda-semana-3 {
  border-left: 2px solid #ea384c !important;
  border-right: 2px solid #ea384c !important;
}

.borda-semana-4 {
  border-left: 2px solid #000000 !important;
  border-right: 2px solid #000000 !important;
}

.borda-semana-5 {
  border-left: 2px solid #ea384c !important;
  border-right: 2px solid #ea384c !important;
}

/* Dimensionamento das colunas com valores fixos em mm */
.ficha-coluna-nome {
  width: 70mm;
  border-right: 2px solid #000;
}

.ficha-coluna-faltas {
  text-align: center;
}

/* Subcolunas de falta ajustadas para mostrar apenas o dia */
.ficha-subcoluna-falta {
  width: 9mm;
  font-size: 11pt;
  font-weight: bold;
  border-left: 0.5px solid #999;
  border-right: 0.5px solid #999;
  padding-top: 0;
  padding-bottom: 1px;
  vertical-align: top;
}

.ficha-coluna-semana {
  text-align: center;
}

.ficha-subcoluna {
  width: 9mm;
  font-size: 9pt;
  border-left: 0.5px solid #999;
  border-right: 0.5px solid #999;
  padding-top: 0;
  padding-bottom: 1px;
  vertical-align: top;
}

/* Headers de semana e faltas */
.semana-header,
.faltas-header {
  font-weight: bold;
  font-size: 9pt;
}

@media print {

  .semana-header,
  .faltas-header {
    font-size: 9pt;
  }
}

/* Estilos da célula do nome do aluno */
.ficha-celula-nome {
  display: flex;
  align-items: center;
  gap: 4px;
  text-align: left !important;
  padding-left: 2px !important;
  position: relative !important;
  overflow: visible !important;
  z-index: 10;
}

.ficha-aluno-numero {
  font-weight: bold;
  text-align: center;
  background-color: #eee;
  width: 16px;
  height: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  flex-shrink: 0;
  font-size: 8pt;
}

.ficha-aluno-nome {
  font-size: 9pt;
  padding-top: 0;
  padding-bottom: 4px;
  display: inline-block;
  vertical-align: top;
  z-index: 100;
  background-color: rgba(255, 255, 255, 0.95);
  padding-right: 4px;
  white-space: nowrap;
  overflow: visible !important;
}

@media print {
  .ficha-aluno-nome {
    font-size: 9pt;
  }

  .ficha-aluno-numero {
    width: 16px;
    height: 16px;
    font-size: 8pt;
  }
}

/* Estilos da coluna de faltas */
.ficha-celula-falta {
  padding: 0 !important;
  vertical-align: top;
}

.falta-campo {
  height: 14px;
  width: 100%;
  margin-top: 0;
  margin-bottom: 1px;
}

/* Estilos das células de semana */
.ficha-celula-semana {
  padding: 0 !important;
  vertical-align: top;
}

.semana-campo-valor {
  height: 14px;
  width: 100%;
  background-color: #fff;
  margin-top: 0;
  margin-bottom: 1px;
}

@media print {

  .falta-campo,
  .semana-campo-valor {
    height: 14px !important;
  }
}

/* Título da seção de reposições */
.ficha-reposicoes-titulo {
  margin: 4px 0 4px 0;
  padding: 3px 0;
  text-align: center;
  font-size: 12pt;
  font-weight: bold;
  border-top: 1px dashed #999;
  border-bottom: 1px dashed #999;
}

@media print {
  .ficha-reposicoes-titulo {
    margin: 4px 0 4px 0 !important;
    padding: 3px 0 !important;
    font-size: 12pt !important;
  }
}

/* Rodapé */
.ficha-rodape {
  text-align: center;
  margin-top: 4px;
  padding-top: 4px;
  border-top: 1px solid #ccc;
}

.ficha-logo {
  font-weight: bold;
  font-style: italic;
  font-size: 10pt;
}

@media print {
  .ficha-rodape {
    margin-top: 4px !important;
    padding-top: 4px !important;
  }

  .ficha-logo {
    font-size: 10pt !important;
  }
}